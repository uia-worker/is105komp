<!DOCTYPE html>
<html lang="no-NB">
<head>
    <meta charset="utf-8">
    <title>IS-105 Tolke kode: Strukturer</title>
    <link href='https://fonts.googleapis.com/css?family=IBM Plex Serif' rel='stylesheet'>
    <link rel="stylesheet" type="text/css" href="styles/is105-style.css" title="default">
    <script type="text/javascript" src="js/is105.js"></script>
</head>
<body>
  <div class="tocset">
    <div class="tocview">
      <div class="tocviewlist tocviewlisttopspace">
        <div class="tocviewtitle">
          <table cellspacing="0" cellpadding="0">
            <tbody>
              <tr>
                <td style="width: 1em;">
              <a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">▼</a>
                </td>
                <td>
                </td>
                <td>
                  <a href="index.html" class="tocviewlink" data-pltdoc="x">Vår 2023: IS-105</a>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
        <div class="tocviewsublisttop" style="display: block;" id="tocview_0">
          <table cellspacing="0" cellpadding="0">
            <tbody>
            <tr>
              <td align="right">
              </td>
              <td>
                <a href="index.html" class="tocviewlink" data-pltdoc="x">Beskrivelse og rettningslinjer</a>
              </td>
            </tr>
            <tr>
              <td align="right">
              </td>
              <td>
                <a href="automater.html" class="tocviewlink" data-pltdoc="x">Kompendium</a>
              </td>
            </tr>
            <tr>
              <td align="right">
              </td>
              <td>
                <a href="oppgaver.html" class="tocviewlink" data-pltdoc="x">Oppgaver</a>
              </td>
            </tr>
            <tr>
              <td align="right">
              </td>
              <td>
                <a href="honnor.html" class="tocviewlink" data-pltdoc="x">Honnør</a>
              </td>
            </tr>
            </tbody>
          </table>
        </div>
      </div>
      <div class="tocviewlist">
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td style="width: 1em;">
                <a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_1&quot;);">▼</a>
              </td>
              <td>
              </td>
              <td>
                <a href="oppgaver.html" class="tocviewlink" data-pltdoc="x">Oppgaver</a>
              </td>
            </tr>
          </tbody>
        </table>
        <div class="tocviewsublistbottom" style="display: block;" id="tocview_1">
          <table cellspacing="0" cellpadding="0">
            <tbody>
              <tr>
                <td align="right"></td>
                <td>
                  <a href="leserefl.html" class="tocviewlink" data-pltdoc="x">Lese og reflektere</a>
                </td>
              </tr>
              <tr>
                <td align="right"></td>
                <td>
                  <a href="tolkekode.html" class="tocviewselflink" data-pltdoc="x">Tolke kode</a>
                </td>
              </tr>
              <tr>
                <td align="right"></td>
                <td>
                  <a href="#testimpl" class="tocviewlink" data-pltdoc="x">Teste og implementere</a>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <div class="tocviewlist">
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr>
              <td style="width: 1em;">
                <a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_1&quot;);">▼</a>
              </td>
              <td>
              </td>
              <td>
                <a href="oppgaver.html" class="tocviewlink" data-pltdoc="x">Tolke kode (oppgaver)</a>
              </td>
            </tr>
          </tbody>
        </table>
        <div class="tocviewsublistbottom" style="display: block;" id="tocview_1">
          <table cellspacing="0" cellpadding="0">
            <tbody>
              <tr>
                <td align="right"></td>
                <td>
                  <a href="variabler.html" class="tocviewlink" data-pltdoc="x">Variabler</a>
                </td>
              </tr>
              <tr>
                <td align="right"></td>
                <td>
                  <a href="kontroll.html" class="tocviewlink" data-pltdoc="x">Kontrollstrukturer</a>
                </td>
              </tr>
              <tr>
                <td align="right"></td>
                <td>
                  <a href="#" class="tocviewselflink" data-pltdoc="x">Datastrukturer</a>
                </td>
              </tr>
              <tr>
                <td align="right"></td>
                <td>
                  <a href="#" class="tocviewlink" data-pltdoc="x">Systemkall</a>
                </td>
              </tr>
              <tr>
                <td align="right"></td>
                <td>
                  <a href="#" class="tocviewlink" data-pltdoc="x">Strøm</a>
                </td>
              </tr>
              <tr>
                <td align="right"></td>
                <td>
                  <a href="#" class="tocviewlink" data-pltdoc="x">Samtidighet</a>
                </td>
              </tr>
              <tr>
                <td align="right"></td>
                <td>
                  <a href="#" class="tocviewlink" data-pltdoc="x">Protokoller</a>
                </td>
              </tr>
              <tr>
                <td align="right"></td>
                <td>
                  <a href="#" class="tocviewlink" data-pltdoc="x">HTTP</a>
                </td>
              </tr>
              <tr>
                <td align="right"></td>
                <td>
                  <a href="#" class="tocviewlink" data-pltdoc="x">Sikkerhet</a>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
  <div class="maincolumn">
    <h1>
      Datastrukturer
      <a name="kontroll"></a>
    </h1>

    <h2>
      Introduksjon
      <a name="variabler"></a>
    </h2>

    <p>Denne oppgaven er i kategorien <a href="tolkekode.html">"Tolke kode"</a>.</p>
    <p>Formålet med denne oppgaven er å bli kjent med datastrukturer i Go. Oppgaven er basert på  <a href="https://go.dev/tour/moretypes/1" target="_blank">"A Tour of Go"</a> (avsnitt "More types: structs, slices, and maps").</p>

    <h2>
      Tidsbruk og tips
      <a name="tidsbruk"></a>
    </h2>
    <p>3-4 timer.</p>
    <p>Quizen vil være tilgjengelig i Canvas <span style="color:lightgreen;">fredag 27. Januar 2023 10:15</span>. Hvis du må bruke mer tid en antydet både for studier og quizen, søk hjelp.</p>

    <h2>
      Mer om evaluering
      <a name="evaluering"></a>
    </h2>
    <p>Husk at svarene dine som er feil, er av mye større verdi enn de som er riktig. Feil svar gir oss muligheten til å forstå hva du eventuelt har misforstått. Derfor skal vi evaluere oppgaven ved å se om du har fulgt våre anbefalinger om fremgangsmåten som beskrevet i <a href="tolkekode.html">"Tolke kode"</a>.</p>


    <h2>
      Tour of Go: "More types: structs, slices and maps"
      <a name="instruks"></a>
    </h2>


    <p>I denne oppgaven skal du gå gjennom websidene <b>1-18</b> (legg merke til side nummer nederst i den venstre kolonnen på "Tour of Go" websiden) i avsnittet "More types: structs, slices and maps". I denne omgangen ser dere ikke på <code style="color: #cfcecc;">map</code>.</p>

    <p>Her er noen kommentarer for sidene i avsnittet <a href="https://go.dev/tour/moretypes/1" target="_blank">"More types: structs, slices and maps"</a>.</p>

    <h3>
      Pointers
        <a name="h3-pointers"></a>
    </h3>
    <p>På side 1 introduseres pekere. Pekere har en sammenheng med den abstrakte modellen for det fysiske minne i datamaskinen. En meget enkel minnemodell beskriver minne som en tabell av bytes (se Figur 1). Bytes i denne konteksten er 8 bits. Avhengig av maskinvaren, er hver bit lagret i en minnecelle som består av 1-6 transistorer.</p>

    <p>&nbsp;</p>
    <img src="images/very-simple-memory-modell.svg" width="300" alt="Very simple computer memory model">
    <p>Figur 1. Veldig enkel minnemodell for datamaskinen.</p>
    <p>Verdien til en peker er en minneadresse i minnetabellen (se Figur 1) og blir ofte fremstilt med den laveste adressen nederst. <code style="color: #cfcecc;">0x00000000</code> i Figur 1 er representert med et heksadesimalt tall og er på 32 bits siden hvert symbol i et heksadesimalt tall, utenon <code style="color: #cfcecc;">Ox</code> representerer 4 bits. Det er operativsystemet som kontrollerer det fysiske minne. Brukerprogrammer "ser" et virtuelt minne, som har et eget adresserom. De virtuelle heksadesimale adressene er av liten nytte for en programmerer av brukerprogrammer. En programmere av drivere vil ha behov for å bruke de fysiske adressene, som kan ikke aksesseres fra brukerprogrammer.</p>

    <pre><code>
    func main() {
      var n int // vi kan finne verdien til n vha. av navn
      var p *int // definerer en peker-variabel
      p = &n    // peker-variabel holder adressen til i
      // forrige to linjer er ekvivalent med 'p := &n'
      fmt.Println(*p) // finner verdien pekeren p peker på
      fmt.Println(n) // finner i ved å bruke navn til variabelen direkte
    }
    </code></pre>
    <p>Kodefragment 1. Hva er en peker i Go?</p>
    <p>Kodefragment 1 illustrerer forskjell på en variabel av "vanlig" type, som <code style="color: #cfcecc;">int</code> og en peker-variabel, som er av typen <code style="color: #cfcecc;">*int</code> (typer til peker-variablene betegnes med <code style="color: #cfcecc;">*</code> foran typen, dvs. generelt <code style="color: #cfcecc;">*T</code>, hvor <code style="color: #cfcecc;">T</code> er en standard- eller egendefinert type i Golang).</p>

    <img src="images/pointer-example-tour-of-go.svg" width="300" alt="Very simple computer memory model">
    <p>Figur 2. Eksempel fra Tour og Go illustrert.</p>
    <p>I Figur 2 er eksemplet fra Tour of Go analysert. To variabler <code style="color: #cfcecc;">i</code> og <code style="color: #cfcecc;">j</code> av typen <code style="color: #cfcecc;">int</code> og en variabel <code style="color: #cfcecc;">p</code> av typen <code style="color: #cfcecc;">*int</code> blir definert og verdiene av variablene blir endret ved hjelp av referanse (<code style="color: #cfcecc;">*</code> er referanseoperatør, det motsatte av addresseringsoperatøren <code style="color: #cfcecc;">&</code>). Rekkefølgen på instruksjonene er følgende:
    <ul>
      <li><code style="color: #cfcecc;">p = &i</code>&nbsp;----------- adressering</li>
      <li><code style="color: #cfcecc;">*p = 21</code>&nbsp;---------- referanse</li>
      <li><code style="color: #cfcecc;">p = &j</code>&nbsp;----------- (om)adressering</li>
      <li><code style="color: #cfcecc;">*p = *p / 37</code>&nbsp;--- referanse</li>
    </ul> </p>

    <h3>
      Structs
        <a name="h3-pointers"></a>
    </h3>
    <p>En struktur i Golang har noen likheter med klasser i Java. For eksempel i Java kan man definere en klasse slikt:
      <pre><code>
      // Denne koden er i Java
      public class GameBoard {
        String nameOfGame;
        int numberOfRows;
        int numberOfColumns;
      }
      </code></pre>
      <p>Kodefragment 2. Klasse i Java.</p>
      <p>
      I Golang kan vi bruke struct for å gjøre noe lignende (husk at store forbokstaver er nødvendig, hvis man ønsker å aksessere datafeltene fra andre pakker; i Java brukes reserverte ord <code style="color: #cfcecc;">private</code> og <code style="color: #cfcecc;">public</code> for dette):
      <pre><code>
      type GameBoard struct {
        nameOfGame string
        numberOfRows int
        numberOfColumns int
      }
      </code></pre>
      <p>Kodefragment 3. Struct i Go.</p>
    </p>
    <p>I Java definerer man nye typer ved hjelp av en ny klasse, mens i Golang kan nye typer defineres med hjelpeordet <code style="color: #cfcecc;">type</code>. I Java kan man ikke definere egne typer basert på primitive typer som <code style="color: #cfcecc;">int</code> og <code style="color: #cfcecc;">float</code>, mens i Golang er det mulig (for eksempel <code style="color: #cfcecc;">type minInt int</code>).</p>
    <p>I Java en instans av en klasse skapes ved å bruke det reserverte ordet <code style="color: #cfcecc;">new</code> (det forutsetter at det er implementert en såkalt <code style="color: #cfcecc;">constructor</code> metode, for å kunne spesifisere verdiene til datafeltene i samme setning):
      <pre><code>
      // Denne koden er i Java
      GameBoard ticTacToe = new GameBoard("TicTacToe", 3, 3);
      </code></pre>
      <p>Kodefragment 4. Instans i Java.</p>
    </p>
    <p>I Golang kan man også bruke et reservert ord <code style="color: #cfcecc;">new</code>, men da må man huske på at man skaper en peker, dvs.
      <pre><code>
      var ticTacToe *GameBoard = new(GameBoard)
      ticTacToe.nameOfGame = "TicTacToe"
      ...
      </code></pre>
      <p>Kodefragment 5. Instans i Go med new().</p>
      Kodefragment 5 viser også hvordan man kan aksessere datafelt i en Go <code style="color: #cfcecc;">struct</code> (likt som i tilfelle med Java instanser).</p>
      <p>
      I Golang finnes det ikke noen mekanismer for <code style="color: #cfcecc;">constructor</code>, men man kan bruke en syntaks som kalles for "struct literal" (fritt oversatt, kan det bety å skrive noe bokstavelig eller presist). Man kan definere instanser med ingen alle eller noen datafelt definert på følgende måter:
      <pre><code>
      var (
        ticTacToeVer1 = GameBoard{"TicTacToe", 3, 3}
        // Her blir nameOfGame initialisert med en tom streng ""
        ticTacToeVer2 = GameBoard{numberOfRows: 3, numberOfColums: 3}
        // Her blir alle datafelt i struct initialisert
        // med "default" verdier "", 0, 0
        ticTacToeVer3 = GameBoard{}
      )
      </code></pre>
      </p>
      <p>Kodefragment 6. Bokstavelige instanser (en. struct literals).</p>

      <p>Til ettertanke, så er klasseinstanser i Java egentlig pekere, men det gjenspeiles ikke i syntaksen på samme måten som i Golang. Man kan også tenke på Golang strukturer som frittstående elementer, mens i Java er klassene noe mer rigide. Man må, blant annet, definere klasser i egne filer (med mindre man bruker spesifikke mekanismer og dermed også spesifikk syntaks). I Golang kan typer og strukturer defineres løst og er ikke bundet til filer. Senere vil vi se hvordan man kan knytte strukturer til metoder (i Java skriver man metodene rett inn i "scope" til en klasse).</p>
      <p>Man kan også definere peker til en struct ved hjelp av adressering og manipulere struct-en ved hjelp av referanser:
        <pre><code>
        ticTacToeVer1 = GameBoard{"TicTacToe", 3, 3}
        p := &ticTacToeVer1
        *p.nameOfGame = "TTT"
        </code></pre>
        <p>Kodefragment 7. Peker til struct i Go.</p>
      </p>
      <h3>
        Arrays og Slices
          <a name="h3-arrays"></a>
      </h3>
      <p>
      Ordet "array" finnes ikke i det norske vokabulæret. Det kan oversettes som "tabell" eller "matrise". Jeg vi bruke "array" videre i dette dokumentet, slik at det er enklere å relatere det til lesestoffet på engelsk.</p>

      <p>Det er vanskelig å programmere med kun primitive typer (<code style="color: #cfcecc;">int</code>, <code style="color: #cfcecc;">float</code>, <code style="color: #cfcecc;">bool</code>, <code style="color: #cfcecc;">byte</code>) og definere en variabel av gangen. Andre typer for  datastrukturer, som finnes i alle programmringspråk, er de såkalte kontainertyper. I kontainertyper kan man lagre diverse kolleksjoner (lister) av elementer. Det tre viktigste kontainertyper i Go er <em>array, slice og map</em>. Alle elementene i en kolleksjon som er lagret i en kontainertype må være av samme type. Hvert element i kontaineren kan aksesseres med en indeks eller nøkkel (en. key). For eksempel i en array <code style="color: #cfcecc;">var os [2]string = [2]string{"macOS", "MS Windows"}</code> elementet "macOS" kan aksesseres med indeks 0, dvs <code style="color: #cfcecc;">osNavn := os[0]</code>. Elementet kan også endres ved hjelp av indeks <code style="color: #cfcecc;">os[0] = "iOS"</code>.</p>


      <p>Array i Golang defineres etter mønster <code style="color: #cfcecc;">[n]T</code>, hvor <code style="color: #cfcecc;">n</code> er antall elementer i array av type <code style="color: #cfcecc;">T</code>. Arrays i Golang må være definert med en konstant størrelse, dvs. de kan ikke endre størrelse under utførelse av programmet. Verdiene til array kan selvsagt endres under utførelse. Hvis man ikke kjenner størrelsen på array før man skal utføre programmet, trenger man en <em>dynamisk array</em> og må da bruke <em>slice</em> ("skive" på norsk). Mønster for å definere <em>slice</em> er <code style="color: #cfcecc;">[]T</code>. Så forskjellen fra array er at ingen spesifikk størrelse for <em>slice</em> blir gitt ved definisjon.
      </p>

      <p>Under hver <em>slice</em> ligger en array, som er den reelle allokeringen av minne. Man kan se på <em>slice</em> som en peker til et området i den underliggende array. Man kan definere en <em>slice</em> på flere måter:
        <pre><code>
        var arr [3]int              // en array med "default" verdier
        sliceArr := arr[:]          // fra en predefinert array
        sliceEx := []int{1,2,3}     // "bokstavelig" (en. slice literals)
        matrise := make([][]uint8, 3) // med det reserverte ordet make
        </code></pre>
        <p>Kodefragment 8. Allokering av slice.</p>
      </p>

      <p>Man kan utvide <em>slice</em> med en innebygd funksjon i Go, som heter <a href="https://pkg.go.dev/builtin#append">append</a>. Funksjonen utvider en <em>slice</em>, hvis den underliggende array har plass. Hvis den underliggende array ikke har plass, så lages det en ny <em>slice</em>, som ikke lenger er knyttet til den underliggende array. Den nye <em>slice</em> peker på en ny underliggende array.</p>
      <img src="images/big-picture-explanation-slices.svg" width="500" alt="Go slices">
      <p>Figur 3. Go slices (illustrativ forklaring).</p>

      <p>Figur 3 illustrerer viktige konsepter med <em>slice</em>. Man kan lage så mange <em>slices</em> som man ønsker over en array. Enhver endring i <em>slice</em> som peker på et området i array, vil også forårsake endring i den underliggende array. I Figur 3 er det vist at man kan, for eksempel, endre den 9-ende verdien i array <code style="color: #cfcecc;">heks</code> fra <em>slices</em> <code style="color: #cfcecc;">sliceTall</code> og <code style="color: #cfcecc;">sliceOverlapp</code>. Legg også merke til størrelsen (eller lengde) og kapasiteten til de forskjellige <em>slices</em>. Kapasiteten er relatert til kapasiteten til den underliggende array. Lengden er antall elementer i <em>slice</em>.
      </p>

      <h3>
        Relevante Go pakker
        <a name="h3-gopackages"></a>
      </h3>

    <p>Pakkene fra standardbiblioteket som introduseres i denne oppgaven er:
      <ul>
        <li><a href="https://pkg.go.dev/fmt" target="_blank">fmt</a></li>
        <li><a href="https://pkg.go.dev/time" target="_blank">time</a></li>
        <li><a href="https://pkg.go.dev/math" target="_blank">math</a></li>
        <li><a href="https://pkg.go.dev/golang.org/x/tour/pic">golang.org/x/tour/pic</a> </li>
      </ul>

    <h2>
      Referanser
      <a name="referanser"></a>
    </h2>
    <ul>
      <li>(A Tour of Go, 2022) <a href="https://go.dev/tour/list" style="color: #ffc42d;">A Tour of Go</a></li>
      <li>Dwen. (2022, February 15). A detailed explanation of pointers in Golang - Dev Genius. Medium; Dev Genius. https://blog.devgenius.io/a-detailed-explanation-of-pointers-in-golang-87e659d29095</li>
      <li>Wrigstad, T. (2018). Pointers. Wrigstad.com. http://wrigstad.com/ioopm18/pointers.html (Wrigstad, 2018)</li>
      <li>Understanding Type in Go. (2013). Ardanlabs.com. https://www.ardanlabs.com/blog/2013/07/understanding-type-in-go.html (Understanding Type in Go, 2013)</li>
      <li>Pointers in Go -Go 101. (2016). Go101.org. https://go101.org/article/pointer.html (Pointers in Go -Go 101, 2016)</li>
      <li>https://www.youtube.com/watch?v=Bln-v9LmZ3E (fysisk minnecelle)</li>
      <li>https://medium.com/@ankur_anand/a-visual-guide-to-golang-memory-allocator-from-ground-up-e132258453ed</li>
      <li>Arrays, Slices and Maps in Go -Go 101. (2016). Go101.org. https://go101.org/article/container.html</li>

    </ul>


  </div>
</body>
</html>
